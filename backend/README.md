# yaarxiv backend

![Backend Build and Deploy Status](https://img.shields.io/github/workflow/status/ddadaal/yaarxiv/Build%20and%20Publish%20backend?label=Backend%20Build%20and%20Deploy&style=flat-square)
![Backend Coveralls](https://img.shields.io/coveralls/github/ddadaal/yaarxiv?label=Backend%20Test%20Coverage&style=flat-square)

# Features

- Auto parse the `schemas.json` (located at and generated by the api project) for model validation, faster serialization and deserialization, route specification, swagger generation.
- [nanoid](https://github.com/ai/nanoid) for user id generation
- [bcrypt](https://github.com/dcodeIO/bcrypt.js) to protect passwords

# Tools Used

- fastify
- mikro-orm
- TypeScript
- eslint

# Development

```bash
# Run command under . context, not under the whole project's root

# Start a local MySQL for dev and local test
# Username: root, Password: dbfordev
# The db files are stored under ./db which is gitignored.
npm run devenv

# Install dependencies
npm install

# Run migrations
npx mikro-orm migration:up

# Start
npm start

# Stop the dev db
npm run devenv:stop
```

# Configuration

[node-config](https://github.com/lorenwest/node-config) is used for configuration. Create config files on `config` dir according to its strategy.


For example, you will need a `production.json` (which can be based on `production.sample.json`) for production deployment.

See `config/default.json` for default config.

# Deployment

For env consistency, we recommend testing production build with docker only.

